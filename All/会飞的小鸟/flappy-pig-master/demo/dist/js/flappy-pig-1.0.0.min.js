/*! flappy-pig-1.0.0 2014-04-13 02:19:53 */
var flappy=function(a){"use strict";return a.option={g:400,v0:400,vp:2.5,frequency:20,levels:100,safeLift:500,floorHeight:64,pigWidth:33,pigHeight:30,pigY:300,pigLeft:80,pillarHtml:'<div class="top"></div><div class="bottom"></div>',pillarWidth:45,pillarGapY:108,pillarGapX:250,pillarTop:-550,pillarBottom:-500},a}(flappy||{}),flappy=function(a){"use strict";return a.util={preventDefaultEvent:function(a){a=window.event||a,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},$:function(a){return document.getElementById(a)},getChilds:function(a){for(var b=a.children||a.childNodes,c=[],d=0,e=b.length;e>d;d++)1==b[d].nodeType&&c.push(b[d]);return c}},a}(flappy||{}),flappy=function(a){"use strict";var b=a.option,c=a.util.$;return a.pig={Y:0,init:function(a,d){var e=this;e.s=0,e.time=0,e.$pig=c("pig"),e.$pig.style.left=b.pigLeft+"px",e._controller=d,e._addListener(a)},_addListener:function(a){this._overCallback=a},start:function(){var a=this,c=b.frequency/1e3;a.s=b.v0*a.time-a.time*a.time*b.g*2,a.Y=b.pigY+a.s,a.Y>=b.floorHeight?a.$pig.style.bottom=a.Y+"px":a._dead(),a.time+=c},jump:function(){var a=this;b.pigY=parseInt(a.$pig.style.bottom,10),a.s=0,a.time=0},_dead:function(){this._overCallback.call(this._controller)},fall:function(){var a=this;a.Y=b.floorHeight,a.$pig.style.bottom=a.Y+"px"},hit:function(){var a=this,c=setInterval(function(){a.$pig.style.bottom=a.Y+"px",a.Y<=b.floorHeight&&clearInterval(c),a.Y-=12},b.frequency)}},a}(flappy||{}),flappy=function(a){"use strict";var b=a.option,c=a.util,d=c.$;return a.pillar={currentId:-1,init:function(){var a=this;a._factor=b.pillarBottom-b.pillarGapY+450,a._s=b.pigLeft+b.pigWidth+10,a._render()},_render:function(){var a=this,e=b.safeLift;a.left=0,a.dom=document.createElement("div"),a.dom.className=a.dom.id="pillarWrapper";for(var f=0,g=b.levels;g>f;f++){var h=document.createElement("div");h.innerHTML=b.pillarHtml,h.className="pillar",h.id="pillar-"+f,h.style.left=e+"px";var i=c.getChilds(h),j=i[0],k=i[1],l=a._random(f);j.style.top=l.top+"px",k.style.bottom=l.bottom+"px",h.setAttribute("top",600+l.top),h.setAttribute("bottom",0-l.bottom),a.dom.appendChild(h),e+=b.pillarGapX}d("screen").appendChild(a.dom)},_random:function(a){var c=this,d=Math.random(),e=290*Math.abs(Math.sin((a+1)*d));return{top:b.pillarTop+e,bottom:c._factor-e}},move:function(){var a=this;a.dom.style.left=-a.left+"px",a._find(a.left),a.left+=b.vp},_find:function(a){var c=this,d=(c._s+a-b.safeLift)/b.pillarGapX,e=parseInt(d,10);d>0&&c.currentId!=e&&Math.abs(d-e)<.1&&(c.currentId=e)}},a}(flappy||{}),flappy=function(a){"use strict";var b=a.pig,c=a.pillar,d=a.option,e=a.util.$;return a.position={init:function(a,b){var c=this;c.pillarWrapper=e("pillarWrapper"),c.pigX1=d.pigLeft,c.pigX2=d.pigLeft+d.pigWidth,c._controller=b,c._addListener(a)},_addListener:function(a){this._overCallback=a},judge:function(){var a=this,f=e("pillar-"+c.currentId);-1!=c.currentId&&(a.pigY2=600-b.Y,a.pigY1=a.pigY2-d.pigHeight,a.pY1=f.getAttribute("top"),a.pY2=f.getAttribute("bottom"),a.pX1=parseInt(f.style.left,10)+parseInt(a.pillarWrapper.style.left,10),a.pX2=a.pX1+d.pillarWidth,console.log(a.pillarWrapper.style.left),d.pigLeft+d.pigWidth>=a.pX1&&d.pigLeft<=a.pX2&&(a.pigY1<a.pY1||a.pigY2>a.pY2)&&a._dead())},_dead:function(){this._overCallback.call(this._controller)}},a}(flappy||{}),flappy=function(a){"use strict";var b=a.pig,c=a.pillar,d=a.position,e=a.util,f=e.$,g=a.option;return a.controller={init:function(){var a=this;a._isStart=!1,a._timer=null,b.init(a.fall,a),c.init(),d.init(a.hit,a),a.addKeyListener()},addKeyListener:function(){var a=this;document.onkeydown=function(b){b=b||event;var c=b.keyCode||b.which||b.charCode;32==c&&(a.jump(),e.preventDefaultEvent(b))}},jump:function(){var a=this;a._isStart?b.jump():(f("begin").style.display="none",a._createTimer(function(){b.start(),c.move(),d.judge(),f("score").innerHTML=c.currentId+1}),a._isStart=!0)},hit:function(){var a=this;a.over(),b.hit()},fall:function(){var a=this;a.over(),b.fall()},over:function(){var a=this;clearInterval(a._timer),f("end").style.display="block"},_createTimer:function(a){var b=this;b._timer=setInterval(a,g.frequency)}},a}(flappy||{}),flappy=function(a){"use strict";var b=(a.controller,a.option),c=a.pig,d=a.pillar,e=a.position,f=a.util,g=a.util.$;return a.game={init:function(){var a=this;a._isStart=!1,a._isEnd=!1,a._timer=null,c.init(a.fall,a),d.init(),e.init(a.hit,a),a.addKeyListener()},addKeyListener:function(){var a=this;document.onkeydown=function(b){b=b||event;var c=b.keyCode||b.which||b.charCode;32==c&&(a._isEnd?window.location.reload():a.jump(),f.preventDefaultEvent(b))}},jump:function(){var a=this;a._isStart?c.jump():(g("start").style.display="none",a._createTimer(function(){c.start(),d.move(),e.judge(),g("score").innerHTML=d.currentId+1}),a._isStart=!0)},hit:function(){var a=this;a.over(),c.hit()},fall:function(){var a=this;a.over(),c.fall()},over:function(){var a=this;clearInterval(a._timer),a._isEnd=!0,g("end").style.display="block"},_createTimer:function(a){var c=this;c._timer=setInterval(a,b.frequency)}},flappy.init=function(){a.game.init()},a}(flappy||{});